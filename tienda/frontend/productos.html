<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Tienda | Productos</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    /* -------------------------
       RESET B√ÅSICO
    -------------------------- */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --bg-main: #020617;
      --bg-elevated: rgba(15, 23, 42, 0.85);
      --bg-elevated-solid: #0f172a;
      --bg-soft: #020617;
      --accent: #f97316;
      --accent-soft: rgba(249, 115, 22, 0.14);
      --accent-strong: #fb923c;
      --text-main: #e5e7eb;
      --text-muted: #9ca3af;
      --border-subtle: rgba(148, 163, 184, 0.35);
      --shadow-soft: 0 18px 45px rgba(0, 0, 0, 0.65);
      --radius-lg: 18px;
      --radius-md: 12px;
      --radius-full: 999px;
      --blur-glass: 14px;
      --transition-fast: 0.16s ease-out;
      --transition-med: 0.22s ease-out;
      --header-height: 64px;
      --max-width: 1200px;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #020617, #020617 40%, #020617);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* -------------------------
       LAYOUT GENERAL
    -------------------------- */
    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header.site-header {
      position: sticky;
      top: 0;
      z-index: 40;
      backdrop-filter: blur(18px);
      background: linear-gradient(
        to bottom,
        rgba(15, 23, 42, 0.95),
        rgba(15, 23, 42, 0.78),
        transparent
      );
      border-bottom: 1px solid rgba(31, 41, 55, 0.9);
    }

    .header-inner {
      max-width: 1100px;
      margin: 0 auto;
      height: var(--header-height);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1.5rem;
      gap: 1rem;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .brand-logo {
      width: 32px;
      height: 32px;
      border-radius: 14px;
      background: radial-gradient(circle at 30% 0, #f97316, #1d4ed8 55%, #020617);
      box-shadow: 0 10px 30px rgba(248, 113, 22, 0.65);
    }

    .brand-text {
      display: flex;
      flex-direction: column;
      gap: 0.1rem;
    }

    .brand-title {
      font-size: 1.05rem;
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .brand-sub {
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    nav.site-nav {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.9rem;
    }

    .nav-link {
      padding: 0.35rem 0.75rem;
      border-radius: 999px;
      color: var(--text-muted);
      border: 1px solid transparent;
      cursor: pointer;
      transition: background var(--transition-fast),
        color var(--transition-fast),
        border-color var(--transition-fast),
        transform var(--transition-fast);
    }

    .nav-link:hover {
      background: rgba(15, 23, 42, 0.7);
      color: var(--text-main);
      border-color: rgba(248, 250, 252, 0.2);
      transform: translateY(-1px);
    }

    .nav-link.active {
      background: rgba(15, 23, 42, 0.7);
      color: var(--text-main);
      border-color: rgba(248, 250, 252, 0.2);
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .desktop-filters {
      display: flex;
      gap: 0.75rem;
      align-items: center;
    }

    .select {
      position: relative;
    }

    .select select {
      appearance: none;
      width: 100%;
      padding: 0.6rem 2rem 0.6rem 0.75rem;
      border-radius: var(--radius-full);
      border: 1px solid var(--border-subtle);
      background: var(--bg-elevated);
      color: var(--text-main);
      font-size: 0.85rem;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .select::after {
      content: "‚ñº";
      position: absolute;
      right: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.7rem;
      color: var(--text-muted);
      pointer-events: none;
    }

    .select select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.1);
    }

    .pill-filter {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.4rem 0.75rem;
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      background: var(--bg-elevated);
      color: var(--text-muted);
      font-size: 0.8rem;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .pill-filter:hover {
      border-color: var(--accent);
      color: var(--text-main);
      transform: translateY(-1px);
    }

    .pill-filter.active {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }

    .dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--text-muted);
      transition: background var(--transition-fast);
    }

    .pill-filter.active .dot {
      background: white;
    }

    .menu-paginas {
      display: flex;
      gap: 0.75rem;
      margin-left: 1rem;
    }

    .menu-paginas a {
      padding: 0.35rem 0.75rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.7);
      color: var(--text-muted);
      font-size: 0.85rem;
      cursor: pointer;
      transition: 0.2s;
      text-decoration: none;
    }

    .menu-paginas a:hover {
      background: rgba(15, 23, 42, 1);
      color: var(--text-main);
      border-color: rgba(248, 250, 252, 0.2);
      transform: translateY(-1px);
    }

    .cart-button {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 0.6rem;
      padding: 0.55rem 1.2rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: var(--text-main);
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      transition: background var(--transition-fast), border-color var(--transition-fast),
        transform var(--transition-fast), box-shadow var(--transition-fast);
    }

    .cart-button:hover {
      background: rgba(15, 23, 42, 1);
      border-color: rgba(248, 250, 252, 0.2);
      transform: translateY(-1px);
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.75);
    }

    .cart-icon {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
    }

    .cart-count {
      min-width: 22px;
      height: 22px;
      border-radius: 999px;
      background: #f97316;
      color: #020617;
      font-size: 0.85rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 0.3rem;
    }

    /* -------------------------
       MAIN & CONTROLES
    -------------------------- */
    main.site-main {
      flex: 1;
      max-width: 1100px;
      margin: 0 auto;
      padding: 1.6rem 1.5rem 2.5rem;
    }

    .hero {
      margin-bottom: 1.8rem;
    }

    .hero-title-row {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 0.4rem;
    }

    .hero-title {
      font-size: 1.5rem;
      letter-spacing: 0.02em;
    }

    .hero-pill {
      font-size: 0.78rem;
      padding: 0.25rem 0.75rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-muted);
      background: rgba(15, 23, 42, 0.85);
    }

    .hero-subtitle {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    /* CONTROLES - DISE√ëO SHOPIFY M√ìVIL */
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .search-wrapper {
      flex: 1;
      min-width: 200px;
      position: relative;
    }

    .search-input {
      width: 100%;
      padding: 0.6rem 1rem 0.6rem 2.5rem;
      border-radius: var(--radius-full);
      border: 1px solid var(--border-subtle);
      background: var(--bg-elevated);
      color: var(--text-main);
      font-size: 0.9rem;
      transition: all var(--transition-fast);
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.1);
    }

    .search-icon {
      position: absolute;
      left: 0.75rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1rem;
      color: var(--text-muted);
    }

    /* Bot√≥n de Filtros */
    .filters-button {
      display: none;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      border-radius: var(--radius-full);
      border: 1px solid var(--border-subtle);
      background: var(--bg-elevated);
      color: var(--text-main);
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all var(--transition-fast);
      position: relative;
    }

    .filters-button:hover {
      background: var(--accent-soft);
      border-color: var(--accent);
      transform: translateY(-1px);
    }

    .filters-count {
      position: absolute;
      top: -4px;
      right: -4px;
      background: var(--accent);
      color: white;
      font-size: 0.7rem;
      font-weight: 600;
      padding: 0.15rem 0.35rem;
      pointer-events: none;
    }

    /* Estilos para Filtros Activos (Estilo Shopify) */
    .filtro-activo {
      background: #ff6b35 !important;
      border-color: #ff6b35 !important;
      color: white !important;
    }

    .filtro-activo:hover {
      background: #e55a2b !important;
      border-color: #e55a2b !important;
    }

    /* Pills de filtros activos en escritorio */
    .pill-filter.filtro-activo {
      background: #ff6b35 !important;
      border-color: #ff6b35 !important;
      color: white !important;
    }

    /* Opciones de filtros m√≥viles activas */
    .filter-option.filtro-activo {
      background: #ff6b35 !important;
      border-color: #ff6b35 !important;
      color: white !important;
    }

    /* Checkbox "Solo disponibles" activo */
    .checkbox-label.filtro-activo .checkbox-custom {
      background: #ff6b35 !important;
      border-color: #ff6b35 !important;
    }

    .checkbox-label.filtro-activo {
      color: #ff6b35 !important;
    }

    /* Panel de Filtros M√≥vil */
    .filters-panel {
      display: none; /* Oculto por defecto en desktop */
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-elevated-solid);
      border-radius: var(--radius-lg) var(--radius-lg) 0 0;
      box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.3);
      transform: translateY(100%);
      transition: transform 0.3s ease-out;
      max-height: 80vh;
      overflow-y: auto;
      z-index: 60;
    }

    .filters-panel.open {
      transform: translateY(0);
    }

    .filters-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem;
      border-bottom: 1px solid var(--border-subtle);
    }

    .filters-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-main);
    }

    .filters-close {
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      padding: 0.5rem;
      border-radius: var(--radius-md);
      transition: all var(--transition-fast);
    }

    .filters-close:hover {
      background: var(--bg-hover);
      color: var(--text-main);
    }

    .filters-content {
      padding: 1rem;
    }

    .filter-group {
      margin-bottom: 1.5rem;
    }

    .filter-label {
      display: block;
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-main);
      margin-bottom: 0.75rem;
    }

    .filter-options {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .filter-option {
      padding: 0.5rem 0.75rem;
      border-radius: var(--radius-md);
      border: 1px solid var(--border-subtle);
      background: var(--bg-elevated);
      color: var(--text-muted);
      cursor: pointer;
      transition: all var(--transition-fast);
      font-size: 0.85rem;
    }

    .filter-option:hover {
      background: var(--bg-hover);
      border-color: var(--border-main);
    }

    .filter-option.active {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }

    .filter-checkbox {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .filter-checkbox input[type="checkbox"] {
      display: none;
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      cursor: pointer;
      font-size: 0.9rem;
      color: var(--text-main);
    }

    .checkbox-custom {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      background: var(--bg-elevated);
      position: relative;
      transition: all var(--transition-fast);
    }

    .checkbox-custom::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 6px;
      width: 6px;
      height: 10px;
      border: solid white;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
      opacity: 0;
      transition: opacity var(--transition-fast);
    }

    .filter-checkbox input[type="checkbox"]:checked + .checkbox-label .checkbox-custom {
      background: var(--accent);
      border-color: var(--accent);
    }

    .filter-checkbox input[type="checkbox"]:checked + .checkbox-label .checkbox-custom::after {
      opacity: 1;
    }

    .filters-footer {
      padding: 1rem;
      border-top: 1px solid var(--border-subtle);
      display: flex;
      gap: 0.75rem;
    }

    .filters-apply, .filters-clear {
      flex: 1;
      padding: 0.75rem 1rem;
      border-radius: var(--radius-md);
      border: none;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .filters-apply {
      background: var(--accent);
      color: white;
    }

    .filters-apply:hover {
      background: var(--accent-dark);
    }

    .filters-clear {
      background: var(--bg-elevated);
      color: var(--text-muted);
      border: 1px solid var(--border-subtle);
    }

    .filters-clear:hover {
      background: var(--bg-hover);
      color: var(--text-main);
    }

    .pill-filter {
      flex: 0 0 auto;
      font-size: 0.78rem;
      padding: 0.35rem 0.75rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--text-muted);
      background: rgba(15, 23, 42, 0.9);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      transition: background var(--transition-fast), color var(--transition-fast),
        border-color var(--transition-fast), transform var(--transition-fast);
    }

    .pill-filter span.dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.8);
    }

    .pill-filter.active {
      color: #fef3c7;
      border-color: rgba(248, 250, 252, 0.45);
      background: linear-gradient(
        to right,
        rgba(249, 115, 22, 0.15),
        rgba(36, 99, 235, 0.16)
      );
    }

    .pill-filter.active span.dot {
      background: #f97316;
    }

    /* -------------------------
       GRID DE PRODUCTOS
    -------------------------- */
    #products-section {
      display: flex;
      justify-content: center;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, 220px);
      justify-content: center;
      gap: 1.2rem;
      margin: 0 auto 2rem;
      max-width: 1100px;
    }

    .card {
      width: 220px;
      border-radius: 18px;
      overflow: hidden;
      border: 1px solid rgba(31, 41, 55, 0.95);
      background: radial-gradient(circle at top, #020617, #020617 40%, #020617);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.55);
      transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease;
      cursor: default;
    }

    .card:hover {
      transform: translateY(-6px);
      border-color: rgba(148, 163, 184, 0.7);
      box-shadow: 0 22px 55px rgba(0, 0, 0, 0.9);
      background: radial-gradient(circle at top, #020617, #020617 55%, #020617);
    }

    .card-image {
      width: 100%;
      height: 160px;
      background: radial-gradient(circle at 20% 0, #1f2937, #020617 75%);
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      border-bottom: 1px solid rgba(31, 41, 55, 0.95);
      position: relative;
    }

    .card-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.4s ease-out, filter 0.4s ease-out;
    }

    .card:hover .card-image img {
      transform: scale(1.04);
      filter: saturate(1.1);
    }

    .card-image-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(
        to top,
        rgba(15, 23, 42, 0.85),
        transparent 55%
      );
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition-med);
    }

    .card:hover .card-image-overlay {
      opacity: 1;
    }

    .card-image-zoom {
      position: absolute;
      right: 10px;
      bottom: 10px;
      padding: 0.3rem 0.7rem;
      border-radius: 999px;
      font-size: 0.8rem;
      background: rgba(15, 23, 42, 0.85);
      border: 1px solid rgba(148, 163, 184, 0.7);
      color: var(--text-main);
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      opacity: 0;
      transform: translateY(4px);
      pointer-events: none;
      transition: opacity var(--transition-med), transform var(--transition-med);
    }

    .card:hover .card-image-zoom {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    .card-image-zoom span.icon {
      font-size: 0.85rem;
    }

    .card-body {
      padding: 0.85rem 0.9rem 0.95rem;
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
    }

    .card-title-row {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 0.5rem;
    }

    .card-title {
      font-size: 0.96rem;
      font-weight: 500;
    }

    .card-price {
      font-size: 0.95rem;
      font-weight: 600;
      color: #f97316;
    }

    .price {
      font-size: 1rem;
      font-weight: 600;
      color: #e5e7eb;
    }

    .price-original {
      font-size: 0.9rem;
      color: #9ca3af;
      text-decoration: line-through;
      margin-right: 0.35rem;
    }

    .price-offer {
      font-size: 1rem;
      font-weight: 700;
      color: #4ade80;
    }

    .badge-oferta {
      display: inline-block;
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
      background: #f97316;
      color: #111827;
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .card-meta-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .badge {
      padding: 0.18rem 0.55rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.55);
      background: rgba(15, 23, 42, 0.9);
      font-size: 0.75rem;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
    }

    .badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.95);
    }

    .stock {
      font-size: 0.78rem;
      font-weight: 500;
    }

    .stock.en {
      color: #4ade80;
    }

    .stock.sin {
      color: #f97316;
    }

    .card-footer {
      margin-top: 0.4rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
      padding-top: 0.5rem;
      border-top: 1px dashed rgba(31, 41, 55, 0.9);
    }

    .qty-controls {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.95);
      padding: 0.2rem 0.35rem;
    }

    .qty-btn {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: none;
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background var(--transition-fast),
        transform var(--transition-fast),
        box-shadow var(--transition-fast);
    }

    .qty-btn:hover {
      background: rgba(30, 64, 175, 0.95);
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(30, 64, 175, 0.75);
    }

    .qty-value {
      min-width: 18px;
      text-align: center;
      font-size: 0.82rem;
    }

    .qty-clear {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      border: none;
      background: rgba(127, 29, 29, 0.95);
      color: #fee2e2;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background var(--transition-fast),
        transform var(--transition-fast),
        box-shadow var(--transition-fast);
    }

    .qty-clear:hover {
      background: rgba(185, 28, 28, 1);
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(185, 28, 28, 0.65);
    }

    .add-to-cart {
      flex: 1;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.35rem;
      padding: 0.35rem 0.7rem;
      border-radius: 999px;
      border: none;
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      background: var(--accent-soft);
      color: #fed7aa;
      transition: background var(--transition-fast), transform var(--transition-fast),
        box-shadow var(--transition-fast), color var(--transition-fast),
        border-color var(--transition-fast);
      border: 1px solid rgba(248, 250, 252, 0.0);
    }

    .add-to-cart:hover {
      background: radial-gradient(circle at top left, #f97316, #c2410c);
      color: #111827;
      box-shadow: 0 12px 30px rgba(249, 115, 22, 0.65);
      transform: translateY(-1px);
      border-color: rgba(248, 250, 252, 0.22);
    }

    .add-to-cart:active {
      transform: translateY(0);
      box-shadow: 0 6px 18px rgba(249, 115, 22, 0.55);
    }

    .add-to-cart[disabled] {
      opacity: 0.4;
      cursor: not-allowed;
      background: rgba(100, 100, 100, 0.2);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .qty-btn[disabled],
    .qty-clear[disabled] {
      opacity: 0.4;
      cursor: not-allowed;
      background: rgba(100, 100, 100, 0.2);
    }

    /* -------------------------
       PAGINACI√ìN
    -------------------------- */
    .pagination {
      display: flex;
      justify-content: center;
      gap: 0.35rem;
      flex-wrap: wrap;
      margin-bottom: 1.2rem;
    }

    .page-btn {
      min-width: 28px;
      height: 28px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background var(--transition-fast),
        transform var(--transition-fast),
        border-color var(--transition-fast),
        box-shadow var(--transition-fast),
        color var(--transition-fast);
    }

    .page-btn:hover {
      background: rgba(15, 23, 42, 1);
      border-color: rgba(248, 250, 252, 0.2);
      transform: translateY(-1px);
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.8);
    }

    .page-btn.active {
      background: radial-gradient(circle at top left, #f97316, #1d4ed8);
      border-color: rgba(248, 250, 252, 0.35);
      color: #020617;
      font-weight: 600;
      box-shadow: 0 10px 28px rgba(0, 0, 0, 0.9);
      transform: translateY(-1px);
    }

    /* -------------------------
       MENSAJE VAC√çO / ERROR
    -------------------------- */
    .empty,
    .error-msg {
      text-align: center;
      color: var(--text-muted);
      font-size: 0.9rem;
      padding: 1.5rem 0.75rem;
    }

    .error-msg {
      color: #fecaca;
    }

    /* -------------------------
       RESPONSIVE DESIGN - EVITAR SOLAPAMIENTOS
    -------------------------- */
    @media (max-width: 768px) {
      .site-header {
        flex-direction: column;
        align-items: flex-start;
        width: 100%;
        gap: 0.6rem;
      }

      .site-nav {
        flex-wrap: wrap;
        width: 100%;
        gap: 0.4rem;
      }

      .menu-paginas {
        flex-wrap: wrap;
        width: 100%;
        gap: 0.4rem;
      }

      .menu-paginas a {
        flex-shrink: 0;
        white-space: nowrap;
      }

      .grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 1rem;
      }

      .card {
        width: 100%;
        min-height: auto;
      }

      .card-title {
        font-size: 0.9rem;
        line-height: 1.2;
      }

      .card-price-row {
        flex-wrap: wrap;
      }

      .modal-content {
        width: 92%;
        max-height: 90vh;
        overflow-y: auto;
        padding: 1rem;
      }

      .modal-image {
        height: 180px;
        object-fit: contain;
      }

      .modal-title {
        font-size: 1.1rem;
        line-height: 1.3;
      }

      .modal-description {
        font-size: 0.9rem;
        line-height: 1.4;
      }

      .cart-panel {
        width: 92%;
        max-height: 90vh;
        overflow-y: auto;
      }

      .cart-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }

      .cart-item img {
        width: 70px;
        height: 70px;
      }

      .cart-item-info {
        width: 100%;
      }

      #banner {
        font-size: 0.9rem;
        padding: 0.5rem 0.7rem;
        text-align: center;
        line-height: 1.3;
        word-break: break-word;
      }
    }

    /* -------------------------
       MODAL DE IMAGEN + INFO (GLASS)
    -------------------------- */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.98), #020617);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
      padding: 1.5rem;
    }

    .modal-backdrop.visible {
      display: flex;
    }

    .modal-glass {
      max-width: 920px;
      width: 100%;
      border-radius: 26px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.92), rgba(15, 23, 42, 0.9));
      backdrop-filter: blur(18px);
      box-shadow: 0 28px 80px rgba(0, 0, 0, 0.95);
      padding: 1.2rem;
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1fr);
      gap: 1.1rem;
      position: relative;
    }

    @media (max-width: 768px) {
      .modal-glass {
        grid-template-columns: 1fr;
      }
    }

    .modal-close {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 28px;
      height: 28px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      cursor: pointer;
      transition: background var(--transition-fast),
        transform var(--transition-fast),
        box-shadow var(--transition-fast);
    }

    .modal-close:hover {
      background: rgba(185, 28, 28, 0.95);
      box-shadow: 0 8px 22px rgba(185, 28, 28, 0.75);
      transform: translateY(-1px);
    }

    .modal-image-wrap {
      border-radius: 20px;
      overflow: hidden;
      background: radial-gradient(circle at top, #1f2937, #020617 80%);
      border: 1px solid rgba(31, 41, 55, 0.95);
    }

    .modal-image-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      max-height: 460px;
    }

    .modal-info {
      display: flex;
      flex-direction: column;
      gap: 0.55rem;
    }

    .modal-title {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .modal-price {
      font-size: 1rem;
      font-weight: 600;
      color: #f97316;
    }

    .modal-desc {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-top: 0.2rem;
    }

    .modal-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
      margin-top: 0.35rem;
    }

    .modal-stock {
      font-size: 0.82rem;
      margin-top: 0.3rem;
    }

    .modal-actions {
      margin-top: 0.6rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
    }

    .modal-actions .qty-controls {
      margin-right: 0.2rem;
    }

    /* -------------------------
       CARRITO LATERAL
    -------------------------- */
    .cart-panel {
      position: fixed;
      right: 0;
      top: 0;
      bottom: 0;
      width: min(360px, 90vw);
      background: rgba(15, 23, 42, 0.97);
      border-left: 1px solid rgba(148, 163, 184, 0.35);
      backdrop-filter: blur(16px);
      box-shadow: -10px 0 40px rgba(0, 0, 0, 0.9);
      transform: translateX(100%);
      transition: transform 0.23s ease-out;
      z-index: 45;
      display: flex;
      flex-direction: column;
    }

    .cart-panel.visible {
      transform: translateX(0);
    }

    .cart-header {
      padding: 0.9rem 1rem;
      border-bottom: 1px solid rgba(31, 41, 55, 0.95);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
    }

    .cart-title {
      font-size: 0.95rem;
      font-weight: 500;
    }

    .cart-body {
      flex: 1;
      overflow-y: auto;
      padding: 0.75rem 0.8rem 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.55rem;
    }

    .cart-item {
      display: flex;
      gap: 0.55rem;
      padding: 0.6rem;
      border-radius: 14px;
      border: 1px solid rgba(31, 41, 55, 0.95);
      background: rgba(15, 23, 42, 0.95);
    }

    .cart-thumb {
      width: 46px;
      height: 46px;
      border-radius: 12px;
      overflow: hidden;
      background: #020617;
      flex-shrink: 0;
    }

    .cart-thumb img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .cart-info {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .cart-name {
      font-size: 0.86rem;
    }

    .cart-meta {
      font-size: 0.76rem;
      color: var(--text-muted);
    }

    .cart-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.4rem;
      margin-top: 0.2rem;
    }

    .cart-footer {
      padding: 0.8rem 1rem 0.9rem;
      border-top: 1px solid rgba(31, 41, 55, 0.95);
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .cart-summary {
      display: flex;
      align-items: center;
      justify-content: space-between;
      font-size: 0.9rem;
    }

    .cart-total {
      font-weight: 600;
      color: #f97316;
    }

    .cart-empty {
      font-size: 0.85rem;
      color: var(--text-muted);
      text-align: center;
      padding: 0.7rem 0.5rem;
    }

    .cart-checkout {
      margin-top: 0.2rem;
      padding: 0.45rem 0.75rem;
      border-radius: 999px;
      border: none;
      background: radial-gradient(circle at top left, #f97316, #1d4ed8);
      color: #020617;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.35rem;
      box-shadow: 0 12px 30px rgba(249, 115, 22, 0.7);
      transition: transform var(--transition-fast),
        box-shadow var(--transition-fast),
        filter var(--transition-fast);
    }

    .cart-checkout:hover {
      transform: translateY(-1px);
      filter: brightness(1.04);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.9);
    }

    /* -------------------------
       BANNER
    -------------------------- */
    .banner {
      width: 100%;
      padding: 0.7rem 1rem;
      text-align: center;
      font-size: 1rem;
      font-weight: 500;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    /* -------------------------
       FOOTER
    -------------------------- */
    footer.site-footer {
      border-top: 1px solid rgba(31, 41, 55, 0.95);
      padding: 0.9rem 1.5rem 1rem;
      font-size: 0.78rem;
      color: var(--text-muted);
      text-align: center;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.9), #020617);
    }

    .footer-inner {
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: 0.5rem;
    }

    .footer-links {
      display: flex;
      gap: 0.7rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    .footer-link {
      color: var(--text-muted);
      cursor: pointer;
      transition: color var(--transition-fast), transform var(--transition-fast);
    }

    .footer-link:hover {
      color: var(--text-main);
      transform: translateY(-1px);
    }

    /* -------------------------
       RESPONSIVE
    -------------------------- */
    
    /* Desktop: Ocultar completamente elementos m√≥viles */
    @media (min-width: 769px) {
      .filters-panel {
        display: none !important;
      }
      
      .filters-button {
        display: none !important;
      }
      
      .mobile-menu-overlay {
        display: none !important;
      }
    }
    
    /* Men√∫ Hamburguesa - Oculto en Desktop */
    .mobile-menu-toggle {
      display: none;
      flex-direction: column;
      justify-content: space-between;
      width: 24px;
      height: 18px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
    }

    .mobile-menu-toggle span {
      display: block;
      height: 2px;
      width: 100%;
      background: var(--text-main);
      border-radius: 2px;
      transition: all 0.3s ease;
    }

    .mobile-menu-overlay {
      display: none;
    }

    /* Desktop Navigation - Oculta en M√≥vil */
    @media (max-width: 768px) {
      /* -------------------------
         MEN√ö M√ìVIL - DISE√ëO COMPLETAMENTE DIFERENTE
      -------------------------- */
      
      /* Ocultar navegaci√≥n desktop */
      #desktop-nav {
        display: none;
      }

      /* Mostrar men√∫ hamburguesa */
      .mobile-menu-toggle {
        display: flex;
      }

      /* Ocultar filtros desktop */
      .desktop-filters {
        display: none;
      }

      /* Mostrar bot√≥n de filtros m√≥vil */
      .filters-button {
        display: flex;
      }

      /* Ocultar filtros desktop en m√≥vil */
      .desktop-filters {
        display: none;
      }

      /* Panel de filtros m√≥vil visible */
      .filters-panel {
        display: block;
      }

      /* Header adaptado para m√≥vil */
      .site-header {
        backdrop-filter: blur(12px);
        background: linear-gradient(
          to bottom,
          rgba(15, 23, 42, 0.98),
          rgba(15, 23, 42, 0.85)
        );
      }

      .header-inner {
        padding: 0.75rem 1rem;
        height: auto;
        min-height: 56px;
      }

      .brand {
        flex: 1;
      }

      .brand-logo {
        width: 28px;
        height: 28px;
      }

      .brand-title {
        font-size: 0.95rem;
      }

      .brand-sub {
        font-size: 0.72rem;
      }

      .cart-button span {
        display: none; /* Ocultar texto "Carrito" en m√≥vil */
      }

      .cart-button {
        padding: 0.4rem 0.6rem;
        min-width: auto;
      }

      /* Controles adaptados */
      .controls {
        flex-direction: row;
        gap: 0.75rem;
        padding: 1rem 0;
        align-items: center;
      }

      .search-wrapper {
        flex: 1;
        min-width: 0;
      }

      .search-input {
        font-size: 1rem;
        padding: 0.75rem 1rem 0.75rem 2.5rem;
        height: 48px;
        border-radius: 12px;
      }

      .search-icon {
        left: 0.75rem;
        font-size: 1.1rem;
      }

      /* Panel de filtros m√≥vil */
      .filters-panel {
        display: block;
      }

      /* Grid de productos - 1 o 2 columnas */
      .grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        margin: 0 0 2rem 0;
      }

      .card {
        border-radius: 16px;
        overflow: hidden;
        transition: transform 0.2s ease;
      }

      .card:hover {
        transform: translateY(-2px);
      }

      .card-image {
        height: 140px;
      }

      .card-content {
        padding: 1rem;
      }

      .card-title {
        font-size: 0.95rem;
        line-height: 1.4;
        margin-bottom: 0.5rem;
      }

      .card-price-row {
        margin-bottom: 0.75rem;
      }

      .card-price {
        font-size: 1.1rem;
      }

      .card-price-original {
        font-size: 0.8rem;
      }

      .card-price-offer {
        font-size: 0.9rem;
      }

      .card-stock {
        font-size: 0.75rem;
        margin-bottom: 0.75rem;
      }

      .card-actions {
        flex-direction: column;
        gap: 0.5rem;
      }

      .qty-controls {
        order: -1;
        justify-content: center;
      }

      .qty-btn {
        width: 32px;
        height: 32px;
        font-size: 1rem;
      }

      .qty-value {
        min-width: 32px;
        font-size: 0.9rem;
      }

      .add-to-cart {
        padding: 0.6rem 1rem;
        font-size: 0.9rem;
        border-radius: 10px;
        min-height: 40px;
      }

      /* Modal adaptado */
      .modal-glass {
        grid-template-columns: 1fr;
        max-width: 95vw;
        max-height: 90vh;
        margin: 1rem;
        border-radius: 20px;
      }

      .modal-image-wrap {
        height: 250px;
      }

      .modal-info {
        padding: 1.5rem;
      }

      .modal-title {
        font-size: 1.3rem;
        margin-bottom: 0.75rem;
      }

      .modal-price {
        font-size: 1.2rem;
        margin-bottom: 1rem;
      }

      .modal-desc {
        font-size: 0.9rem;
        margin-bottom: 1rem;
      }

      .modal-tags {
        margin-bottom: 1rem;
      }

      .modal-stock {
        font-size: 0.85rem;
        margin-bottom: 1.5rem;
      }

      .modal-actions {
        flex-direction: column;
        gap: 1rem;
      }

      .qty-controls {
        justify-content: center;
      }

      .add-to-cart {
        padding: 0.75rem 1rem;
        font-size: 1rem;
      }

      /* Carrito lateral adaptado */
      .cart-panel {
        width: 100%;
        max-width: 100%;
        border-radius: 20px 20px 0 0;
      }

      .cart-header {
        padding: 1rem 1.5rem;
      }

      .cart-body {
        padding: 0 1.5rem 1rem;
      }

      .cart-item {
        padding: 0.75rem;
        border-radius: 12px;
      }

      .cart-thumb {
        width: 50px;
        height: 50px;
      }

      .cart-name {
        font-size: 0.9rem;
      }

      .cart-meta {
        font-size: 0.8rem;
      }

      .qty-btn {
        width: 28px;
        height: 28px;
        font-size: 0.9rem;
      }

      .qty-value {
        min-width: 28px;
        font-size: 0.85rem;
      }

      .cart-footer {
        padding: 1rem 1.5rem;
      }

      .cart-summary {
        font-size: 0.95rem;
      }

      .cart-checkout {
        padding: 0.75rem 1rem;
        font-size: 0.95rem;
        min-height: 44px;
      }

      /* Paginaci√≥n adaptada */
      .pagination {
        flex-wrap: wrap;
        gap: 0.5rem;
        padding: 1.5rem 0;
      }

      .pagination button {
        min-width: 40px;
        height: 40px;
        font-size: 0.9rem;
      }

      /* Footer adaptado */
      .site-footer {
        padding: 1rem;
      }

      .footer-inner {
        flex-direction: column;
        text-align: center;
        gap: 0.75rem;
      }

      .footer-links {
        justify-content: center;
      }

      .footer-link {
        font-size: 0.85rem;
        padding: 0.25rem 0.5rem;
      }

      /* Banner adaptado */
      .banner {
        font-size: 0.9rem;
        padding: 0.6rem 1rem;
      }

      /* Empty states */
      .empty, .error-msg {
        font-size: 0.9rem;
        padding: 2rem 1rem;
        text-align: center;
      }

      /* Hero adaptado */
      .hero {
        padding: 1.5rem 0;
        text-align: center;
      }

      .hero-title-row {
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 0.5rem;
      }

      .hero-title {
        font-size: 2rem;
        text-align: center;
      }

      .hero-pill {
        font-size: 0.85rem;
        padding: 0.4rem 0.8rem;
      }

      .hero-subtitle {
        font-size: 0.9rem;
        text-align: center;
        line-height: 1.5;
        max-width: 100%;
      }
    }

    /* Tablets - ajustes intermedios */
    @media (min-width: 769px) and (max-width: 1024px) {
      .grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 1.25rem;
      }
      
      .hero-title {
        font-size: 2.5rem;
      }
    }

    /* Large mobile - ajustes finos */
    @media (max-width: 480px) {
      .grid {
        grid-template-columns: 1fr; /* 1 columna en pantallas muy peque√±as */
      }
      
      .hero-title {
        font-size: 1.75rem;
      }
      
      .card-image {
        height: 180px; /* Im√°genes m√°s grandes en 1 columna */
      }
    }

  </style>
</head>

<body>
  <div class="page">
    <!-- HEADER -->
    <header class="site-header">
      <div class="header-inner">
        <div class="brand">
          <div class="brand-logo"></div>
          <div class="brand-text">
            <div class="brand-title">Tienda</div>
            <div class="brand-sub">Productos Premium</div>
          </div>
        </div>

        <!-- Men√∫ Hamburguesa para M√≥vil -->
        <button class="mobile-menu-toggle" id="mobile-menu-toggle" aria-label="Abrir men√∫">
          <span></span>
          <span></span>
          <span></span>
        </button>

        <!-- Navegaci√≥n Desktop -->
        <nav class="site-nav" id="desktop-nav">
          <button class="nav-link active" type="button">Productos</button>
          <div id="menu-paginas" class="menu-paginas"></div>
        </nav>

        <div class="header-actions">
          <button class="cart-button" id="cart-button">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 2L6 9H3l3 9h12l3-9h-3l-3-7z"/>
              <circle cx="9" cy="21" r="1"/>
              <circle cx="15" cy="21" r="1"/>
            </svg>
            <span>Carrito</span>
            <span class="cart-count" id="cart-count">0</span>
          </button>
        </div>
      </div>

      <!-- Men√∫ M√≥vil (Overlay) -->
      <div class="mobile-menu-overlay" id="mobile-menu-overlay">
        <div class="mobile-menu-header">
          <div class="brand">
            <div class="brand-logo"></div>
            <div class="brand-text">
              <div class="brand-title">Tienda</div>
              <div class="brand-sub">Men√∫</div>
            </div>
          </div>
          <button class="mobile-menu-close" id="mobile-menu-close" aria-label="Cerrar men√∫">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        
        <nav class="mobile-nav">
          <button class="mobile-nav-link active" type="button">Productos</button>
          <div class="mobile-menu-paginas" id="mobile-menu-paginas"></div>
          
          <!-- Bot√≥n de carrito en men√∫ m√≥vil -->
          <button class="mobile-cart-button" id="mobile-cart-button">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 2L6 9H3l3 9h12l3-9h-3l-3-7z"/>
              <circle cx="9" cy="21" r="1"/>
              <circle cx="15" cy="21" r="1"/>
            </svg>
            <span>Ver Carrito</span>
            <span class="cart-count" id="mobile-cart-count">0</span>
          </button>
        </nav>
      </div>
    </header>

    <div id="banner" class="banner" style="display:none;">
      <span id="banner-text"></span>
    </div>

    <!-- MAIN -->
    <main class="site-main">
      <!-- Hero -->
      <section class="hero">
        <div class="hero-title-row">
          <h1 class="hero-title">Cat√°logo de Productos</h1>
          <div class="hero-pill" id="hero-count">Cargando productos‚Ä¶</div>
        </div>
      </section>

      <!-- Controles -->
      <section class="controls">
        <div class="search-wrapper">
          <input
            id="search-input"
            type="search"
            class="search-input"
            placeholder="Buscar productos..."
          />
          <span class="search-icon">üîç</span>
        </div>

        <!-- Bot√≥n de Filtros para M√≥vil -->
        <button class="filters-button" id="filters-button">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 3H2l8 9.46V19l4 2v-8.54L22 3z"/>
          </svg>
          <span>Filtros</span>
          <span class="filters-count" id="filters-count">0</span>
        </button>

        <!-- Filtros Desktop (ocultos en m√≥vil) -->
        <div class="desktop-filters">
          <div class="select">
            <select id="filter-category">
              <option value="">Todas las categor√≠as</option>
            </select>
          </div>
          <div class="select">
            <select id="filter-subcategory">
              <option value="">Todas las subcategor√≠as</option>
            </select>
          </div>
          <button class="pill-filter" id="pill-disponibles" type="button">
            <span class="dot"></span>
            Solo disponibles
          </button>
        </div>
      </section>

      <!-- Panel de Filtros M√≥vil -->
      <div class="filters-panel" id="filters-panel">
        <div class="filters-header">
          <h3 class="filters-title">Filtros</h3>
          <button class="filters-close" id="filters-close" aria-label="Cerrar filtros">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        
        <div class="filters-content">
          <!-- Categor√≠as -->
          <div class="filter-group">
            <label class="filter-label">Categor√≠as</label>
            <div class="filter-options" id="mobile-categories">
              <!-- Se cargar√°n din√°micamente -->
            </div>
          </div>

          <!-- Subcategor√≠as -->
          <div class="filter-group">
            <label class="filter-label">Subcategor√≠as</label>
            <div class="filter-options" id="mobile-subcategories">
              <!-- Se cargar√°n din√°micamente -->
            </div>
          </div>

          <!-- Disponibilidad -->
          <div class="filter-group">
            <label class="filter-label">Disponibilidad</label>
            <div class="filter-checkbox">
              <input type="checkbox" id="mobile-disponibles" />
              <label for="mobile-disponibles" class="checkbox-label">
                <span class="checkbox-custom"></span>
                Solo productos disponibles
              </label>
            </div>
          </div>
        </div>

        <div class="filters-footer">
          <button class="filters-apply" id="filters-apply">
            Aplicar filtros
          </button>
          <button class="filters-clear" id="filters-clear">
            Limpiar todo
          </button>
        </div>
      </div>

      <!-- Grid de productos -->
      <section id="products-section">
        <div id="products-grid" class="grid"></div>
        <div id="empty-message" class="empty" style="display:none;">
          No hay productos que coincidan con los filtros.
        </div>
        <div id="error-message" class="error-msg" style="display:none;">
          Error al cargar los productos. Revisa el servidor.
        </div>
      </section>

      <!-- Paginaci√≥n -->
      <div id="pagination" class="pagination"></div>
    </main>

    <!-- FOOTER -->
    <footer class="site-footer">
      <div class="footer-inner">
        <div>Mini CMS Tienda ¬∑ Frontend p√∫blico</div>
        <div class="footer-links">
          <span class="footer-link">T√©rminos</span>
          <span class="footer-link">Privacidad</span>
          <span class="footer-link">Contacto</span>
        </div>
      </div>
    </footer>
  </div>

  <!-- MODAL IMAGEN + INFO -->
  <div class="modal-backdrop" id="modal">
    <div class="modal-glass">
      <button class="modal-close" id="modal-close" type="button">‚úï</button>
      <div class="modal-image-wrap">
        <img id="modal-image" src="" alt="" />
      </div>
      <div class="modal-info">
        <div class="modal-title" id="modal-title"></div>
        <div class="modal-price" id="modal-price"></div>
        <div class="modal-desc" id="modal-desc"></div>
        <div class="modal-tags" id="modal-tags"></div>
        <div class="modal-stock" id="modal-stock"></div>

        <div class="modal-actions">
          <div class="qty-controls">
            <button class="qty-btn" type="button" id="modal-minus">‚àí</button>
            <div class="qty-value" id="modal-qty">0</div>
            <button class="qty-btn" type="button" id="modal-plus">+</button>
            <button class="qty-clear" type="button" id="modal-clear">‚úï</button>
          </div>
          <button class="add-to-cart" type="button" id="modal-add">
            <span>Agregar al carrito</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- PANEL CARRITO -->
  <aside class="cart-panel" id="cart-panel">
    <div class="cart-header">
      <div class="cart-title">Carrito</div>
      <button class="modal-close" id="cart-close" type="button">‚úï</button>
    </div>
    <div class="cart-body" id="cart-body">
      <div class="cart-empty">Tu carrito est√° vac√≠o.</div>
    </div>
    <div class="cart-footer">
      <div class="cart-summary">
        <span>Total</span>
        <span class="cart-total" id="cart-total">0.00 ‚Ç¨</span>
      </div>
      <button class="cart-checkout" type="button">
        <span>Finalizar (demo)</span>
        <span>‚Üí</span>
      </button>
    </div>
  </aside>

  <script>
    // -------------------------------
    // ESTADO GLOBAL
    // -------------------------------
    let allProducts = [];
    let filteredProducts = [];
    let cart = {}; // { productId: { product, qty } }
    let currentPage = 1;
    const pageSize = 8;
    let currentModalProduct = null;

    // -------------------------------
    // INIT
    // -------------------------------
    document.addEventListener("DOMContentLoaded", () => {
      setupUIEvents();
      setupMobileMenu(); // Inicializar men√∫ m√≥vil
      setupMobileFilters(); // Inicializar filtros m√≥viles
      fetchProducts();
      loadBanner();
      loadMenuPages();
    });

    // -------------------------------
    // BANNER
    // -------------------------------
    async function loadBanner() {
      try {
        const res = await fetch("/api/banner");
        const banner = await res.json();

        const bannerEl = document.getElementById("banner");
        const bannerText = document.getElementById("banner-text");

        if (!banner.visible) {
          bannerEl.style.display = "none";
          return;
        }

        bannerEl.style.display = "block";
        bannerEl.style.background = banner.color_fondo;
        bannerEl.style.color = banner.color_texto;
        bannerText.textContent = banner.texto;

      } catch (err) {
        console.error("Error cargando banner:", err);
      }
    }

    // -------------------------------
    // MENU P√ÅGINAS
    // -------------------------------
    async function loadMenuPages() {
      try {
        const res = await fetch("/api/paginas");
        const pages = await res.json();

        // Cargar p√°ginas en men√∫ desktop
        const container = document.getElementById("menu-paginas");
        container.innerHTML = "";

        // Cargar p√°ginas en men√∫ m√≥vil
        const mobileContainer = document.getElementById("mobile-menu-paginas");
        mobileContainer.innerHTML = "";

        pages
          .filter(p => p.visible == 1)
          .forEach(p => {
            // Desktop menu
            const link = document.createElement("a");
            link.href = `/tienda/pagina.html?p=${p.slug}`;
            link.textContent = p.titulo;
            container.appendChild(link);

            // Mobile menu
            const mobileLink = document.createElement("a");
            mobileLink.href = `/tienda/pagina.html?p=${p.slug}`;
            mobileLink.textContent = p.titulo;
            mobileContainer.appendChild(mobileLink);
          });

      } catch (err) {
        console.error("Error cargando p√°ginas:", err);
      }
    }

    // -------------------------------
    // MEN√ö M√ìVIL
    // -------------------------------
    function setupMobileMenu() {
      const mobileMenuToggle = document.getElementById("mobile-menu-toggle");
      const mobileMenuOverlay = document.getElementById("mobile-menu-overlay");
      const mobileMenuClose = document.getElementById("mobile-menu-close");
      const mobileCartButton = document.getElementById("mobile-cart-button");

      // Abrir men√∫ m√≥vil
      mobileMenuToggle.addEventListener("click", () => {
        mobileMenuOverlay.classList.add("open");
        document.body.style.overflow = "hidden"; // Prevenir scroll
      });

      // Cerrar men√∫ m√≥vil
      mobileMenuClose.addEventListener("click", () => {
        mobileMenuOverlay.classList.remove("open");
        document.body.style.overflow = ""; // Restaurar scroll
      });

      // Cerrar men√∫ al hacer clic fuera
      mobileMenuOverlay.addEventListener("click", (e) => {
        if (e.target === mobileMenuOverlay) {
          mobileMenuOverlay.classList.remove("open");
          document.body.style.overflow = "";
        }
      });

      // Bot√≥n de carrito en men√∫ m√≥vil
      mobileCartButton.addEventListener("click", () => {
        mobileMenuOverlay.classList.remove("open");
        document.body.style.overflow = "";
        // Abrir carrito (misma funci√≥n que el bot√≥n principal)
        document.getElementById("cart-panel").classList.add("visible");
      });

      // Navegaci√≥n m√≥vil
      const mobileNavLinks = document.querySelectorAll(".mobile-nav-link");
      mobileNavLinks.forEach(link => {
        link.addEventListener("click", () => {
          // Cerrar men√∫ despu√©s de navegar
          mobileMenuOverlay.classList.remove("open");
          document.body.style.overflow = "";
        });
      });
    }

    // -------------------------------
    // PANEL DE FILTROS M√ìVIL
    // -------------------------------
    function setupMobileFilters() {
      const filtersButton = document.getElementById("filters-button");
      const filtersPanel = document.getElementById("filters-panel");
      const filtersClose = document.getElementById("filters-close");
      const filtersApply = document.getElementById("filters-apply");
      const filtersClear = document.getElementById("filters-clear");

      // Verificar que los elementos existan
      if (!filtersButton || !filtersPanel || !filtersClose) {
        console.warn("Elementos del panel de filtros m√≥vil no encontrados");
        return;
      }

      // Abrir panel de filtros
      filtersButton.addEventListener("click", () => {
        filtersPanel.classList.add("open");
        document.body.style.overflow = "hidden"; // Prevenir scroll
        // Cargar opciones de filtros al abrir
        loadMobileFilterOptions();
      });

      // Cerrar panel con bot√≥n X
      filtersClose.addEventListener("click", () => {
        filtersPanel.classList.remove("open");
        document.body.style.overflow = ""; // Restaurar scroll
      });

      // Cerrar panel al hacer clic fuera
      filtersPanel.addEventListener("click", (e) => {
        if (e.target === filtersPanel) {
          filtersPanel.classList.remove("open");
          document.body.style.overflow = "";
        }
      });

      // Cerrar panel con tecla Escape
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && filtersPanel.classList.contains("open")) {
          filtersPanel.classList.remove("open");
          document.body.style.overflow = "";
        }
      });

      // Aplicar filtros
      if (filtersApply) {
        filtersApply.addEventListener("click", () => {
          applyMobileFilters();
          filtersPanel.classList.remove("open");
          document.body.style.overflow = "";
        });
      }

      // Limpiar filtros
      if (filtersClear) {
        filtersClear.addEventListener("click", () => {
          clearMobileFilters();
        });
      }
    }

    // Cargar opciones de filtros m√≥viles
    function loadMobileFilterOptions() {
      const mobileCategories = document.getElementById("mobile-categories");
      const mobileSubcategories = document.getElementById("mobile-subcategories");
      const mobileDisponibles = document.getElementById("mobile-disponibles");

      if (!mobileCategories || !mobileSubcategories) return;

      // Obtener categor√≠as y subcategor√≠as
      const categories = new Set();
      const subcategories = new Set();

      allProducts.forEach((p) => {
        if (p.categoria) categories.add(p.categoria);
        if (p.subcategoria) subcategories.add(p.subcategoria);
      });

      // Cargar categor√≠as
      mobileCategories.innerHTML = "";
      
      // Opci√≥n "Todas" (seleccionada por defecto)
      const allCatOption = document.createElement("div");
      allCatOption.className = "filter-option filtro-activo"; 
      allCatOption.textContent = "Todas";
      allCatOption.dataset.value = "";
      allCatOption.addEventListener("click", () => selectMobileCategory(""));
      mobileCategories.appendChild(allCatOption);

      // Categor√≠as reales
      categories.forEach((cat) => {
        const option = document.createElement("div");
        option.className = "filter-option";
        option.textContent = cat;
        option.dataset.value = cat;
        option.addEventListener("click", () => selectMobileCategory(cat));
        mobileCategories.appendChild(option);
      });

      // Cargar subcategor√≠as iniciales
      updateMobileSubcategories("");

      // Sincronizar checkbox "Solo disponibles" con el estado actual
      if (mobileDisponibles) {
        mobileDisponibles.checked = document.getElementById("pill-disponibles").classList.contains("active");
      }
    }

    // Seleccionar categor√≠a m√≥vil
    function selectMobileCategory(category) {
      const mobileCategories = document.getElementById("mobile-categories");
      const categoriesLabel = document.getElementById("mobile-categories-label");
      
      // Actualizar estado visual con clase .filtro-activo
      mobileCategories.querySelectorAll(".filter-option").forEach(opt => {
        opt.classList.remove("filtro-activo", "active");
        if (opt.dataset.value === category) {
          opt.classList.add("filtro-activo", "active");
        }
      });

      // Actualizar texto del label din√°micamente
      if (category) {
        categoriesLabel.textContent = category; // Mostrar nombre de la categor√≠a seleccionada
      } else {
        categoriesLabel.textContent = "Todas las categor√≠as"; // Volver al texto por defecto
      }

      // Actualizar subcategor√≠as
      updateMobileSubcategories(category);
  const mobileDisponibles = document.getElementById("mobile-disponibles");

  if (!mobileCategories || !mobileSubcategories) return;

  // Obtener categor√≠as y subcategor√≠as
  const categories = new Set();
  const subcategories = new Set();

  allProducts.forEach((p) => {
    if (p.categoria) categories.add(p.categoria);
    if (p.subcategoria) subcategories.add(p.subcategoria);
  });

  // Cargar categor√≠as
  mobileCategories.innerHTML = "";
  
  // Opci√≥n "Todas" (seleccionada por defecto)
  const allCatOption = document.createElement("div");
  allCatOption.className = "filter-option filtro-activo"; 
  allCatOption.textContent = "Todas";
  allCatOption.dataset.value = "";
  allCatOption.addEventListener("click", () => selectMobileCategory(""));
  mobileCategories.appendChild(allCatOption);

  // Categor√≠as reales
  categories.forEach((cat) => {
    const option = document.createElement("div");
    option.className = "filter-option";
    option.textContent = cat;
    option.dataset.value = cat;
    option.addEventListener("click", () => selectMobileCategory(cat));
    mobileCategories.appendChild(option);
  });
      
      // Actualizar estado visual
      mobileSubcategories.querySelectorAll(".filter-option").forEach(opt => {
        opt.classList.remove("active");
        if (opt.dataset.value === subcategory) {
          opt.classList.add("active");
        }
      });
    }

    // Aplicar filtros m√≥viles
    function applyMobileFilters() {
      const mobileCategories = document.getElementById("mobile-categories");
      const mobileSubcategories = document.getElementById("mobile-subcategories");
      const mobileDisponibles = document.getElementById("mobile-disponibles");

      // Obtener valores seleccionados
      const selectedCategory = mobileCategories.querySelector(".filter-option.active")?.dataset.value || "";
      const selectedSubcategory = mobileSubcategories.querySelector(".filter-option.active")?.dataset.value || "";
      const soloDisponibles = mobileDisponibles?.checked || false;

      // Sincronizar con filtros de escritorio
      document.getElementById("filter-category").value = selectedCategory;
      document.getElementById("filter-subcategory").value = selectedSubcategory;
      
      // Actualizar pill "Solo disponibles"
      const pillDisponibles = document.getElementById("pill-disponibles");
      if (soloDisponibles) {
        pillDisponibles.classList.add("active");
      } else {
        pillDisponibles.classList.remove("active");
      }

      // Aplicar filtros usando la misma funci√≥n que escritorio
      currentPage = 1;
      applyFilters();
    }

    // Limpiar filtros m√≥viles
    function clearMobileFilters() {
      // Limpiar selecciones visuales
      const mobileCategories = document.getElementById("mobile-categories");
      const mobileSubcategories = document.getElementById("mobile-subcategories");
      const mobileDisponibles = document.getElementById("mobile-disponibles");
      const categoriesLabel = document.getElementById("mobile-categories-label");

      if (mobileCategories) {
        mobileCategories.querySelectorAll(".filter-option").forEach(opt => {
          opt.classList.remove("filtro-activo", "active");
        });
        mobileCategories.querySelector(".filter-option")?.classList.add("filtro-activo", "active"); // Seleccionar "Todas"
      }

      if (mobileSubcategories) {
        mobileSubcategories.querySelectorAll(".filter-option").forEach(opt => {
          opt.classList.remove("filtro-activo", "active");
        });
        mobileSubcategories.querySelector(".filter-option")?.classList.add("filtro-activo", "active"); // Seleccionar "Todas"
      }

      if (mobileDisponibles) {
        mobileDisponibles.checked = false;
      }

      // Restaurar texto del label a "Todas las categor√≠as"
      if (categoriesLabel) {
        categoriesLabel.textContent = "Todas las categor√≠as";
      }

      // Sincronizar con filtros de escritorio
      document.getElementById("filter-category").value = "";
      document.getElementById("filter-subcategory").value = "";
      document.getElementById("pill-disponibles").classList.remove("active");

      // Aplicar filtros limpios
      currentPage = 1;
      applyFilters();
    }

    function setupUIEvents() {
      document.getElementById("search-input").addEventListener("input", () => {
        currentPage = 1;
        applyFilters();
      });

      document.getElementById("filter-category").addEventListener("change", () => {
        currentPage = 1;
        applyFilters();
        updateSubcategoryOptions();
      });

      document.getElementById("filter-subcategory").addEventListener("change", () => {
        currentPage = 1;
        applyFilters();
      });

      document.getElementById("pill-disponibles").addEventListener("click", () => {
        const pill = document.getElementById("pill-disponibles");
        pill.classList.toggle("active");
        currentPage = 1;
        applyFilters();
      });

      document.getElementById("cart-button").addEventListener("click", () => {
        document.getElementById("cart-panel").classList.add("visible");
      });
      document.getElementById("cart-close").addEventListener("click", () => {
        document.getElementById("cart-panel").classList.remove("visible");
      });

      // Modal
      document.getElementById("modal-close").addEventListener("click", closeModal);
      document.getElementById("modal").addEventListener("click", (e) => {
        if (e.target.id === "modal") closeModal();
      });

      document.getElementById("modal-plus").addEventListener("click", () => {
        if (!currentModalProduct) return;
        adjustCartQty(currentModalProduct.id, 1);
        syncModalQty();
      });
      document.getElementById("modal-minus").addEventListener("click", () => {
        if (!currentModalProduct) return;
        adjustCartQty(currentModalProduct.id, -1);
        syncModalQty();
      });
      document.getElementById("modal-clear").addEventListener("click", () => {
        if (!currentModalProduct) return;
        setCartQty(currentModalProduct.id, 0);
        syncModalQty();
      });
      document.getElementById("modal-add").addEventListener("click", () => {
        if (!currentModalProduct) return;
        if (currentModalProduct.stock <= 0) return; // BLOQUEO
        adjustCartQty(currentModalProduct.id, 1);
        syncModalQty();
      });
    }

    // -------------------------------
    // FETCH & FILTROS
    // -------------------------------
    async function fetchProducts() {
      try {
        const res = await fetch("/api/productos");
        if (!res.ok) throw new Error("Error al cargar productos");
        const data = await res.json();
        allProducts = Array.isArray(data) ? data : [];
        buildCategoryOptions();
        applyFilters();
      } catch (err) {
        console.error(err);
        document.getElementById("error-message").style.display = "block";
      }
    }

    function buildCategoryOptions() {
      const categorySelect = document.getElementById("filter-category");
      const subcategorySelect = document.getElementById("filter-subcategory");

      const categories = new Set();
      const subcategories = new Set();

      allProducts.forEach((p) => {
        if (p.categoria) categories.add(p.categoria);
        if (p.subcategoria) subcategories.add(p.subcategoria);
      });

      categorySelect.innerHTML = '<option value="">Todas las categor√≠as</option>';
      categories.forEach((cat) => {
        const opt = document.createElement("option");
        opt.value = cat;
        opt.textContent = cat;
        categorySelect.appendChild(opt);
      });

      subcategorySelect.innerHTML = '<option value="">Todas las subcategor√≠as</option>';
      subcategories.forEach((sub) => {
        const opt = document.createElement("option");
        opt.value = sub;
        opt.textContent = sub;
        subcategorySelect.appendChild(opt);
      });
    }

    function updateSubcategoryOptions() {
      const subcategorySelect = document.getElementById("filter-subcategory");
      const categorySelectValue = document.getElementById("filter-category").value;

      const subcategories = new Set();
      allProducts.forEach((p) => {
        if (categorySelectValue && p.categoria !== categorySelectValue) return;
        if (p.subcategoria) subcategories.add(p.subcategoria);
      });

      subcategorySelect.innerHTML = '<option value="">Todas las subcategor√≠as</option>';
      subcategories.forEach((sub) => {
        const opt = document.createElement("option");
        opt.value = sub;
        opt.textContent = sub;
        subcategorySelect.appendChild(opt);
      });
    }

    function applyFilters() {
      const search = document.getElementById("search-input").value.trim().toLowerCase();
      const cat = document.getElementById("filter-category").value;
      const subcat = document.getElementById("filter-subcategory").value;
      const soloDisponibles = document.getElementById("pill-disponibles").classList.contains("active");

      filteredProducts = allProducts.filter((p) => {
        if (soloDisponibles && parseInt(p.stock, 10) < 1) return false;

        if (cat && p.categoria !== cat) return false;
        if (subcat && p.subcategoria !== subcat) return false;

        if (search) {
          const texto = `${p.nombre || ""} ${p.descripcion || ""}`.toLowerCase();
          if (!texto.includes(search)) return false;
        }

        return true;
      });

      renderProducts();
      updateHeroCount();
      updateFiltersCount(); // Actualizar contador de filtros
    }

    // -------------------------------
    // RENDER
    // -------------------------------
    function renderProducts() {
      const grid = document.getElementById("products-grid");
      const emptyMsg = document.getElementById("empty-message");
      const errorMsg = document.getElementById("error-message");
      const pagination = document.getElementById("pagination");

      errorMsg.style.display = "none";

      if (!filteredProducts.length) {
        grid.innerHTML = "";
        emptyMsg.style.display = "block";
        pagination.innerHTML = "";
        return;
      }

      emptyMsg.style.display = "none";

      const total = filteredProducts.length;
      const totalPages = Math.ceil(total / pageSize);
      if (currentPage > totalPages) currentPage = totalPages || 1;

      const start = (currentPage - 1) * pageSize;
      const end = start + pageSize;
      const items = filteredProducts.slice(start, end);

      grid.innerHTML = "";
      items.forEach((p) => {
        const card = createProductCard(p);
        grid.appendChild(card);
      });

      renderPagination(totalPages);
    }

    function createProductCard(p) {
      const card = document.createElement("article");
      card.className = "card";

      const qtyInCart = cart[p.id]?.qty || 0;

      card.innerHTML = `
        <div class="card-image">
          ${p.imagen ? `<img src="${p.imagen}" alt="${p.nombre || ""}">` : ""}
          <div class="card-image-overlay"></div>
          <button class="card-image-zoom" type="button" data-id="${p.id}">
            <span class="icon">‚§¢</span>
            <span>Ver grande</span>
          </button>
        </div>
        <div class="card-body">
          <div class="card-title-row">
            <h2 class="card-title">${p.nombre || "Producto sin nombre"}</h2>
            ${
              p.en_oferta && p.precio_oferta
                ? `
                  <div class="card-price-row">
                    <span class="price-original">${Number(p.precio || 0).toFixed(2)} ‚Ç¨</span>
                    <span class="price-offer">${Number(p.precio_oferta).toFixed(2)} ‚Ç¨</span>
                  </div>
                `
                : `
                  <div class="card-price">${Number(p.precio || 0).toFixed(2)} ‚Ç¨</div>
                `
            }
            ${
              p.en_oferta && p.precio_oferta
                ? `<span class="badge-oferta">Oferta</span>`
                : ""
            }
          </div>
          <div class="card-meta-row">
            ${p.categoria ? `
              <span class="badge">
                <span class="badge-dot"></span>
                ${p.categoria}
              </span>
            ` : ""}
            ${p.subcategoria ? `
              <span class="badge">
                ${p.subcategoria}
              </span>
            ` : ""}
            <span class="stock ${p.stock > 0 ? "en" : "sin"}">
              ${p.stock > 0
                ? `Quedan ${p.stock} unidad${p.stock === 1 ? "" : "es"}` 
                : "Sin stock"}
            </span>
          </div>
          <div class="card-footer">
            <div class="qty-controls">
              <button class="qty-btn" type="button" data-action="minus" data-id="${p.id}">‚àí</button>
              <div class="qty-value" data-qty-id="${p.id}">${qtyInCart}</div>
              <button class="qty-btn" type="button" data-action="plus" data-id="${p.id}">+</button>
              <button class="qty-clear" type="button" data-action="clear" data-id="${p.id}">‚úï</button>
            </div>
            <button class="add-to-cart" type="button" data-action="add" data-id="${p.id}"
              ${p.stock <= 0 ? "disabled" : ""}>
              <span>${p.stock <= 0 ? "Sin stock" : "Agregar"}</span>
            </button>
          </div>
        </div>
      `;

      // Eventos imagen (modal)
      const zoomBtn = card.querySelector(".card-image-zoom");
      if (zoomBtn) {
        zoomBtn.addEventListener("click", () => openModal(p));
      }

      // Eventos cantidad
      card.querySelectorAll(".qty-btn, .qty-clear, .add-to-cart").forEach((btn) => {
        const id = parseInt(btn.getAttribute("data-id"), 10);
        const action = btn.getAttribute("data-action");
        btn.addEventListener("click", () => {
          if (action === "plus") adjustCartQty(id, 1);
          else if (action === "minus") adjustCartQty(id, -1);
          else if (action === "clear") setCartQty(id, 0);
          else if (action === "add") adjustCartQty(id, 1);
        });
      });

      return card;
    }

    function renderPagination(totalPages) {
      const pagination = document.getElementById("pagination");
      pagination.innerHTML = "";
      if (totalPages <= 1) return;

      for (let i = 1; i <= totalPages; i++) {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "page-btn" + (i === currentPage ? " active" : "");
        btn.textContent = i;
        btn.addEventListener("click", () => {
          currentPage = i;
          renderProducts();
        });
        pagination.appendChild(btn);
      }
    }

    function updateHeroCount() {
      const heroCount = document.getElementById("hero-count");
      const total = filteredProducts.length;
      heroCount.textContent = `${total} producto${total !== 1 ? "s" : ""} visible${total !== 1 ? "s" : ""}`;
    }

    function updateFiltersCount() {
      const filtersCount = document.getElementById("filters-count");
      if (!filtersCount) return;

      // Leer valores reales de los filtros
      const search = document.getElementById("search-input").value.trim().toLowerCase();
      const cat = document.getElementById("filter-category").value;
      const subcat = document.getElementById("filter-subcategory").value;
      const soloDisponibles = document.getElementById("pill-disponibles").classList.contains("active");

      // Contar filtros activos
      let count = 0;
      if (search) count++; // B√∫squeda activa
      if (cat) count++; // Categor√≠a seleccionada
      if (subcat) count++; // Subcategor√≠a seleccionada
      if (soloDisponibles) count++; // Solo disponibles activo

      // Actualizar contador
      filtersCount.textContent = count;

      // Aplicar estilos naranja a filtros activos (Estilo Shopify)
      updateActiveFiltersStyles(search, cat, subcat, soloDisponibles);
    }

    function updateActiveFiltersStyles(search, cat, subcat, soloDisponibles) {
      // Actualizar pill "Solo disponibles" en escritorio
      const pillDisponibles = document.getElementById("pill-disponibles");
      if (soloDisponibles) {
        pillDisponibles.classList.add("filtro-activo");
      } else {
        pillDisponibles.classList.remove("filtro-activo");
      }

      // Actualizar opciones de filtros m√≥viles
      const mobileCategories = document.getElementById("mobile-categories");
      const mobileSubcategories = document.getElementById("mobile-subcategories");
      const mobileDisponibles = document.getElementById("mobile-disponibles");
      const mobileDisponiblesLabel = mobileDisponibles?.nextElementSibling;

      // Categor√≠as m√≥viles
      if (mobileCategories) {
        mobileCategories.querySelectorAll(".filter-option").forEach(opt => {
          if (opt.dataset.value === cat && cat) {
            opt.classList.add("filtro-activo");
          } else {
            opt.classList.remove("filtro-activo");
          }
        });
      }

      // Subcategor√≠as m√≥viles
      if (mobileSubcategories) {
        mobileSubcategories.querySelectorAll(".filter-option").forEach(opt => {
          if (opt.dataset.value === subcat && subcat) {
            opt.classList.add("filtro-activo");
          } else {
            opt.classList.remove("filtro-activo");
          }
        });
      }

      // Checkbox "Solo disponibles" m√≥vil
      if (mobileDisponiblesLabel) {
        if (soloDisponibles) {
          mobileDisponiblesLabel.classList.add("filtro-activo");
        } else {
          mobileDisponiblesLabel.classList.remove("filtro-activo");
        }
      }

      // Actualizar selects de escritorio (si tienen clase especial)
      const categorySelect = document.getElementById("filter-category");
      const subcategorySelect = document.getElementById("filter-subcategory");
      
      if (cat) {
        categorySelect.classList.add("filtro-activo");
      } else {
        categorySelect.classList.remove("filtro-activo");
      }

      if (subcat) {
        subcategorySelect.classList.add("filtro-activo");
      } else {
        subcategorySelect.classList.remove("filtro-activo");
      }

      // Actualizar campo de b√∫squeda si tiene texto
      const searchInput = document.getElementById("search-input");
      if (search) {
        searchInput.classList.add("filtro-activo");
      } else {
        searchInput.classList.remove("filtro-activo");
      }
    }

    function adjustCartQty(productId, delta) {
      const product = allProducts.find((p) => p.id === productId);
      if (!product) return;

      if (delta > 0 && product.stock <= 0) return; // BLOQUEO

      if (!cart[productId]) {
        cart[productId] = { product, qty: 0 };
      }
      cart[productId].qty += delta;
      if (cart[productId].qty <= 0) {
        delete cart[productId];
      }
      updateCartUI();
    }

    function setCartQty(productId, qty) {
      const product = allProducts.find((p) => p.id === productId);
      if (!product) return;
      if (qty <= 0) {
        delete cart[productId];
      } else {
        cart[productId] = { product, qty };
      }
      updateCartUI();
    }

    function updateCartUI() {
      // Contador en header
      const countEl = document.getElementById("cart-count");
      const totalItems = Object.values(cart).reduce((sum, item) => sum + item.qty, 0);
      countEl.textContent = totalItems;

      // Totales - usar precio de oferta si existe
      const totalPrice = Object.values(cart).reduce(
        (sum, item) => {
          const unitPrice = item.product.en_oferta && item.product.precio_oferta
            ? Number(item.product.precio_oferta)
            : Number(item.product.precio || 0);
          return sum + item.qty * unitPrice;
        },
        0
      );
      document.getElementById("cart-total").textContent = totalPrice.toFixed(2) + " ‚Ç¨";

      // Lista carrito
      const cartBody = document.getElementById("cart-body");
      cartBody.innerHTML = "";
      if (!Object.keys(cart).length) {
        const empty = document.createElement("div");
        empty.className = "cart-empty";
        empty.textContent = "Tu carrito est√° vac√≠o.";
        cartBody.appendChild(empty);
      } else {
        Object.values(cart).forEach(({ product, qty }) => {
          const itemEl = document.createElement("div");
          itemEl.className = "cart-item";

          // Calcular precio unitario y total usando oferta si existe
          const unitPrice = product.en_oferta && product.precio_oferta
            ? Number(product.precio_oferta)
            : Number(product.precio || 0);
          const lineTotal = qty * unitPrice;

          itemEl.innerHTML = `
            <div class="cart-thumb">
              ${product.imagen ? `<img src="${product.imagen}" alt="${product.nombre || ""}">` : ""}
            </div>
            <div class="cart-info">
              <div class="cart-name">${product.nombre || "Producto"}</div>
              <div class="cart-meta">
                ${
                  product.en_oferta && product.precio_oferta
                    ? `
                      <span style="text-decoration: line-through; color: #9ca3af; font-size: 0.8rem;">
                        ${Number(product.precio || 0).toFixed(2)} ‚Ç¨
                      </span>
                      <span style="color: #4ade80; font-weight: 600;">
                        ${unitPrice.toFixed(2)} ‚Ç¨
                      </span>
                    `
                    : `<span>${unitPrice.toFixed(2)} ‚Ç¨</span>`
                }
                x ${qty} = <span style="font-weight: 600;">${lineTotal.toFixed(2)} ‚Ç¨</span>
              </div>
              <div class="cart-row">
                <div class="qty-controls">
                  <button class="qty-btn" type="button" data-action="minus" data-id="${product.id}">‚àí</button>
                  <div class="qty-value" data-qty-id="${product.id}">${qty}</div>
                  <button class="qty-btn" type="button" data-action="plus" data-id="${product.id}">+</button>
                  <button class="qty-clear" type="button" data-action="clear" data-id="${product.id}">‚úï</button>
                </div>
              </div>
            </div>
          `;

          itemEl.querySelectorAll(".qty-btn, .qty-clear").forEach((btn) => {
            const id = parseInt(btn.getAttribute("data-id"), 10);
            const action = btn.getAttribute("data-action");
            btn.addEventListener("click", () => {
              if (action === "plus") adjustCartQty(id, 1);
              else if (action === "minus") adjustCartQty(id, -1);
              else if (action === "clear") setCartQty(id, 0);
            });
          });

          cartBody.appendChild(itemEl);
        });
      }

      // Sincronizar cantidades visibles en las cards
      document.querySelectorAll("[data-qty-id]").forEach((el) => {
        const id = parseInt(el.getAttribute("data-qty-id"), 10);
        el.textContent = cart[id]?.qty || 0;
      });

      // Sincronizar modal si est√° abierto
      syncModalQty();
    }

    function syncModalQty() {
      if (!currentModalProduct) return;
      const qty = cart[currentModalProduct.id]?.qty || 0;
      const modalQty = document.getElementById("modal-qty");
      modalQty.textContent = qty;
    }

    function openModal(product) {
      currentModalProduct = product;
      const modal = document.getElementById("modal");
      const modalImage = document.getElementById("modal-image");
      const modalTitle = document.getElementById("modal-title");
      const modalPrice = document.getElementById("modal-price");
      const modalDesc = document.getElementById("modal-desc");
      const modalTags = document.getElementById("modal-tags");
      const modalStock = document.getElementById("modal-stock");
      const modalAdd = document.getElementById("modal-add");

      modalImage.src = product.imagen || "";
      modalTitle.textContent = product.nombre || "Producto sin nombre";
      
      if (product.en_oferta && product.precio_oferta) {
        modalPrice.innerHTML = `
          <span class="price-original">${Number(product.precio || 0).toFixed(2)} ‚Ç¨</span>
          <span class="price-offer">${Number(product.precio_oferta).toFixed(2)} ‚Ç¨</span>
        `;
      } else {
        modalPrice.innerHTML = `
          <span class="price">${Number(product.precio || 0).toFixed(2)} ‚Ç¨</span>
        `;
      }
      
      modalDesc.textContent = product.descripcion || "";
      modalTags.innerHTML = "";
      if (product.categoria) {
        const catBadge = document.createElement("span");
        catBadge.className = "badge";
        catBadge.innerHTML = `
          <span class="badge-dot"></span>
          ${product.categoria}
        `;
        modalTags.appendChild(catBadge);
      }
      if (product.subcategoria) {
        const subcatBadge = document.createElement("span");
        subcatBadge.className = "badge";
        subcatBadge.textContent = product.subcategoria;
        modalTags.appendChild(subcatBadge);
      }
      modalStock.innerHTML = product.stock > 0
        ? `<span style="color:#4ade80;">Quedan ${product.stock} unidad${product.stock === 1 ? "" : "es"}</span>`
        : `<span style="color:#f97316;">Sin stock</span>`;

      modalAdd.disabled = product.stock <= 0;
      if (product.stock <= 0) {
        modalAdd.textContent = "Sin stock";
      } else {
        modalAdd.disabled = false;
        modalAdd.textContent = "Agregar al carrito";
      }

      syncModalQty();

      modal.classList.add("visible");
    }

    function closeModal() {
      document.getElementById("modal").classList.remove("visible");
      currentModalProduct = null;
    }
  </script>
</body>
</html>